{% extends "base.html" %}

{% block title %}Exploratory Data Analysis - WorkWell{% endblock %}

{% block content %}
<div class="container-fluid">
    <!-- Page Header -->
    <div class="row mb-4">
        <div class="col-12">
            <h1 class="display-4 fw-bold text-primary">
                <i class="fas fa-chart-bar"></i> Exploratory Data Analysis
            </h1>
            <p class="lead text-muted">Comprehensive data exploration and visualization</p>
        </div>
    </div>
    
    <!-- Control Panel -->
    <div class="row mb-4">
        <div class="col-12">
            <div class="card">
                <div class="card-header bg-light">
                    <i class="fas fa-filter"></i> Filters & Controls
                </div>
                <div class="card-body">
                    <div class="row">
                        <div class="col-md-3">
                            <label class="form-label">Region</label>
                            <select class="form-select" id="filter-region" multiple>
                                <option value="all">All Regions</option>
                            </select>
                        </div>
                        <div class="col-md-3">
                            <label class="form-label">Industry</label>
                            <select class="form-select" id="filter-industry" multiple>
                                <option value="all">All Industries</option>
                            </select>
                        </div>
                        <div class="col-md-2">
                            <label class="form-label">Age Range</label>
                            <div class="input-group">
                                <input type="number" class="form-control" id="age-min" placeholder="Min" value="18">
                                <input type="number" class="form-control" id="age-max" placeholder="Max" value="65">
                            </div>
                        </div>
                        <div class="col-md-2">
                            <label class="form-label">Work Arrangement</label>
                            <select class="form-select" id="filter-work">
                                <option value="all">All</option>
                                <option value="remote">Remote</option>
                                <option value="office">Office</option>
                                <option value="hybrid">Hybrid</option>
                            </select>
                        </div>
                        <div class="col-md-2">
                            <label class="form-label">&nbsp;</label>
                            <div class="d-grid">
                                <button class="btn btn-primary" onclick="applyFilters()">
                                    <i class="fas fa-sync"></i> Apply Filters
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    
    <!-- Tab Navigation -->
    <ul class="nav nav-tabs mb-4" id="edaTabs" role="tablist">
        <li class="nav-item">
            <a class="nav-link active" data-bs-toggle="tab" href="#demographics">
                <i class="fas fa-users"></i> Demographics
            </a>
        </li>
        <li class="nav-item">
            <a class="nav-link" data-bs-toggle="tab" href="#work-patterns">
                <i class="fas fa-briefcase"></i> Work Patterns
            </a>
        </li>
        <li class="nav-item">
            <a class="nav-link" data-bs-toggle="tab" href="#wellbeing">
                <i class="fas fa-heart"></i> Well-being
            </a>
        </li>
        <li class="nav-item">
            <a class="nav-link" data-bs-toggle="tab" href="#correlations">
                <i class="fas fa-project-diagram"></i> Correlations
            </a>
        </li>
        <li class="nav-item">
            <a class="nav-link" data-bs-toggle="tab" href="#advanced">
                <i class="fas fa-cog"></i> Advanced
            </a>
        </li>
    </ul>
    
    <!-- Tab Content -->
    <div class="tab-content" id="edaTabContent">
        <!-- Demographics Tab -->
        <div class="tab-pane fade show active" id="demographics">
            <div class="row">
                <div class="col-12 mb-4">
                    <div class="card">
                        <div class="card-header">
                            <i class="fas fa-chart-pie"></i> Demographics Overview
                        </div>
                        <div class="card-body">
                            <div id="demographics-chart" style="height: 800px;"></div>
                        </div>
                    </div>
                </div>
                
                <div class="col-md-6">
                    <div class="card">
                        <div class="card-header">Age Distribution Details</div>
                        <div class="card-body">
                            <div id="age-detail-chart" style="height: 400px;"></div>
                        </div>
                    </div>
                </div>
                
                <div class="col-md-6">
                    <div class="card">
                        <div class="card-header">Regional Analysis</div>
                        <div class="card-body">
                            <div id="region-detail-chart" style="height: 400px;"></div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- Work Patterns Tab -->
        <div class="tab-pane fade" id="work-patterns">
            <div class="row">
                <div class="col-12 mb-4">
                    <div class="card">
                        <div class="card-header">
                            <i class="fas fa-clock"></i> Work Arrangement Analysis
                        </div>
                        <div class="card-body">
                            <div id="work-arrangement-chart" style="height: 800px;"></div>
                        </div>
                    </div>
                </div>
                
                <div class="col-md-6">
                    <div class="card">
                        <div class="card-header">Hours Distribution</div>
                        <div class="card-body">
                            <div id="hours-histogram" style="height: 400px;"></div>
                        </div>
                    </div>
                </div>
                
                <div class="col-md-6">
                    <div class="card">
                        <div class="card-header">Industry Comparison</div>
                        <div class="card-body">
                            <div id="industry-hours-chart" style="height: 400px;"></div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- Well-being Tab -->
        <div class="tab-pane fade" id="wellbeing">
            <div class="row">
                <div class="col-12 mb-4">
                    <div class="card">
                        <div class="card-header">
                            <i class="fas fa-fire"></i> Burnout & Mental Health Analysis
                        </div>
                        <div class="card-body">
                            <div id="burnout-analysis-chart" style="height: 800px;"></div>
                        </div>
                    </div>
                </div>
                
                <div class="col-md-6">
                    <div class="card">
                        <div class="card-header">Health Issues Distribution</div>
                        <div class="card-body">
                            <div id="health-issues-chart" style="height: 400px;"></div>
                        </div>
                    </div>
                </div>
                
                <div class="col-md-6">
                    <div class="card">
                        <div class="card-header">Social Isolation Analysis</div>
                        <div class="card-body">
                            <div id="isolation-chart" style="height: 400px;"></div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- Correlations Tab -->
        <div class="tab-pane fade" id="correlations">
            <div class="row">
                <div class="col-12">
                    <div class="card">
                        <div class="card-header">
                            <i class="fas fa-network-wired"></i> Correlation Matrix
                        </div>
                        <div class="card-body">
                            <div id="correlation-matrix" style="height: 700px;"></div>
                        </div>
                    </div>
                </div>
                
                <div class="col-12 mt-4">
                    <div class="card">
                        <div class="card-header">Key Relationships</div>
                        <div class="card-body">
                            <div class="row">
                                <div class="col-md-6">
                                    <h6>Strongest Positive Correlations</h6>
                                    <ul id="positive-corr-list"></ul>
                                </div>
                                <div class="col-md-6">
                                    <h6>Strongest Negative Correlations</h6>
                                    <ul id="negative-corr-list"></ul>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- Advanced Tab -->
        <div class="tab-pane fade" id="advanced">
            <div class="row">
                <div class="col-md-6">
                    <div class="card">
                        <div class="card-header">Custom Scatter Plot</div>
                        <div class="card-body">
                            <div class="row mb-3">
                                <div class="col-6">
                                    <select class="form-select" id="scatter-x">
                                        <option value="Age">Age</option>
                                        <option value="Hours_Per_Week">Hours Per Week</option>
                                        <option value="Work_Life_Balance_Score">WLB Score</option>
                                        <option value="Social_Isolation_Score">Isolation Score</option>
                                    </select>
                                </div>
                                <div class="col-6">
                                    <select class="form-select" id="scatter-y">
                                        <option value="Work_Life_Balance_Score">WLB Score</option>
                                        <option value="Hours_Per_Week">Hours Per Week</option>
                                        <option value="Social_Isolation_Score">Isolation Score</option>
                                        <option value="Age">Age</option>
                                    </select>
                                </div>
                            </div>
                            <button class="btn btn-sm btn-primary" onclick="updateScatterPlot()">
                                Update Plot
                            </button>
                            <div id="custom-scatter" style="height: 400px;"></div>
                        </div>
                    </div>
                </div>
                
                <div class="col-md-6">
                    <div class="card">
                        <div class="card-header">Distribution Explorer</div>
                        <div class="card-body">
                            <select class="form-select mb-3" id="dist-variable">
                                <option value="Age">Age</option>
                                <option value="Hours_Per_Week">Hours Per Week</option>
                                <option value="Work_Life_Balance_Score">WLB Score</option>
                                <option value="Social_Isolation_Score">Isolation Score</option>
                            </select>
                            <div id="distribution-plot" style="height: 400px;"></div>
                        </div>
                    </div>
                </div>
                
                <div class="col-12 mt-4">
                    <div class="card">
                        <div class="card-header">Export Options</div>
                        <div class="card-body">
                            <button class="btn btn-success me-2" onclick="exportReport('pdf')">
                                <i class="fas fa-file-pdf"></i> Export PDF Report
                            </button>
                            <button class="btn btn-info me-2" onclick="exportReport('excel')">
                                <i class="fas fa-file-excel"></i> Export to Excel
                            </button>
                            <button class="btn btn-warning" onclick="exportReport('json')">
                                <i class="fas fa-file-code"></i> Export JSON
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
{% endblock %}

{% block extra_js %}
<script src="{{ url_for('static', filename='js/eda.js') }}"></script>
{% endblock %}