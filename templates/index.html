<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Mental Health Analytics Platform</title>

    <!-- External Libraries -->
    <link href="https://cdnjs.cloudflare.com/ajax/libs/bootstrap/5.3.0/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/4.1.1/animate.min.css" rel="stylesheet">

    <!-- Custom CSS -->
    <link href="{{ url_for('static', filename='css/style.css') }}" rel="stylesheet">

    <!-- Plotly and D3 -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/plotly.js/2.24.1/plotly.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/d3/7.8.5/d3.min.js"></script>
</head>
<body>
    <!-- Loading Screen -->
    <div id="loadingContainer" class="loading-container">
        <div>
            <div class="loading-spinner"></div>
            <div class="loading-text">Đang tải dữ liệu...</div>
        </div>
    </div>

    <!-- Auto-loading Status -->
    <div id="autoLoadingStatus" class="auto-loading-status" style="display: none;">
        <div class="status-indicator loading"></div>
        <span id="statusText">Đang tự động tải dữ liệu...</span>
    </div>

    <!-- Sidebar Navigation -->
    <div id="sidebar" class="sidebar">
        <div style="text-align: center; margin-bottom: 30px;">
            <h4 style="color: white; font-weight: 700;">
                <i class="fas fa-brain" style="color: var(--accent-color);"></i>
                Mental Analytics
            </h4>
        </div>

        <div class="nav-item active" data-section="dashboard">
            <i class="fas fa-tachometer-alt"></i>
            <span>Dashboard</span>
        </div>

        <div class="nav-item" data-section="data-overview">
            <i class="fas fa-database"></i>
            <span>Tổng quan dữ liệu</span>
        </div>

        <div class="nav-item" data-section="visualizations">
            <i class="fas fa-chart-pie"></i>
            <span>Trực quan hóa</span>
        </div>

        <div class="nav-item" data-section="ml-analysis">
            <i class="fas fa-robot"></i>
            <span>Phân tích ML</span>
        </div>

        <div class="nav-item" data-section="clustering">
            <i class="fas fa-project-diagram"></i>
            <span>Phân nhóm</span>
        </div>

        <div class="nav-item" data-section="statistical-tests">
            <i class="fas fa-calculator"></i>
            <span>Kiểm định thống kê</span>
        </div>

        <div class="nav-item" data-section="recommendations">
            <i class="fas fa-lightbulb"></i>
            <span>Khuyến nghị</span>
        </div>
    </div>

    <!-- Sidebar Toggle -->
    <div id="sidebarToggle" class="sidebar-toggle">
        <i class="fas fa-bars"></i>
    </div>

    <!-- Main Content -->
    <div id="mainContent" class="main-content">
        <!-- Header -->
        <div class="header-section animate__animated animate__fadeInDown">
            <h1><i class="fas fa-brain"></i> Mental Health Analytics Platform</h1>
            <p>Hệ thống phân tích chuyên sâu sức khỏe tinh thần người lao động với AI và Machine Learning</p>

            <div style="margin-top: 25px;">
                <button id="reloadDataBtn" class="btn-glass me-3">
                    <i class="fas fa-sync"></i> Tải lại dữ liệu
                </button>
                <button id="startAnalysisBtn" class="btn-glass me-3">
                    <i class="fas fa-play"></i> Phân tích toàn diện
                </button>
                <button id="exportReportBtn" class="btn-glass">
                    <i class="fas fa-download"></i> Xuất báo cáo
                </button>
            </div>
        </div>

        <!-- Alert Messages -->
        <div id="alertContainer"></div>

        <!-- Dashboard Section -->
        <div id="dashboard-section" class="content-section">
            <!-- Quick Stats -->
            <div id="quickStats" class="row">
                <div class="col-md-3">
                    <div class="stats-card animate__animated animate__fadeInUp">
                        <div class="icon"><i class="fas fa-users"></i></div>
                        <div class="value" id="totalRecords">-</div>
                        <div class="label">Tổng số mẫu</div>
                    </div>
                </div>
                <div class="col-md-3">
                    <div class="stats-card animate__animated animate__fadeInUp animate__delay-1s">
                        <div class="icon"><i class="fas fa-columns"></i></div>
                        <div class="value" id="totalColumns">-</div>
                        <div class="label">Số cột dữ liệu</div>
                    </div>
                </div>
                <div class="col-md-3">
                    <div class="stats-card animate__animated animate__fadeInUp animate__delay-2s">
                        <div class="icon"><i class="fas fa-exclamation-triangle"></i></div>
                        <div class="value" id="missingValues">-</div>
                        <div class="label">Giá trị thiếu</div>
                    </div>
                </div>
                <div class="col-md-3">
                    <div class="stats-card animate__animated animate__fadeInUp animate__delay-3s">
                        <div class="icon"><i class="fas fa-memory"></i></div>
                        <div class="value" id="memoryUsage">- MB</div>
                        <div class="label">Dung lượng</div>
                    </div>
                </div>
            </div>

            <!-- Initial Dashboard Chart -->
            <div id="dashboardChart" class="chart-container" style="display: none;">
                <h3 class="chart-title">Dashboard Tổng quan</h3>
                <div id="dashboardPlotArea"></div>
            </div>

            <!-- Features Overview -->
            <div class="row mt-4">
                <div class="col-md-4">
                    <div class="feature-card" data-feature="advanced-viz">
                        <div class="feature-icon"><i class="fas fa-chart-area"></i></div>
                        <div class="feature-title">Trực quan hóa nâng cao</div>
                        <div class="feature-description">Biểu đồ 3D, Sunburst, Heatmap tương tác và Dashboard tổng quan</div>
                    </div>
                </div>
                <div class="col-md-4">
                    <div class="feature-card" data-feature="ml-models">
                        <div class="feature-icon"><i class="fas fa-brain"></i></div>
                        <div class="feature-title">Machine Learning</div>
                        <div class="feature-description">Random Forest, Gradient Boosting, Logistic Regression với cross-validation</div>
                    </div>
                </div>
                <div class="col-md-4">
                    <div class="feature-card" data-feature="clustering">
                        <div class="feature-icon"><i class="fas fa-sitemap"></i></div>
                        <div class="feature-title">Phân nhóm thông minh</div>
                        <div class="feature-description">K-means clustering với PCA projection và silhouette analysis</div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Data Overview Section -->
        <div id="data-overview-section" class="content-section" style="display: none;">
            <div class="chart-container">
                <h3 class="chart-title">Thông tin tổng quan dữ liệu</h3>
                <div id="dataOverviewContent"></div>
            </div>
        </div>

        <!-- Visualizations Section -->
        <div id="visualizations-section" class="content-section" style="display: none;">
            <div class="chart-container">
                <h3 class="chart-title">Trực quan hóa nâng cao</h3>
                <div class="row">
                    <div class="col-12 mb-4">
                        <div id="viz-3d-scatter" class="viz-container"></div>
                    </div>
                    <div class="col-md-6 mb-4">
                        <div id="viz-heatmap" class="viz-container"></div>
                    </div>
                    <div class="col-md-6 mb-4">
                        <div id="viz-sunburst" class="viz-container"></div>
                    </div>
                    <div class="col-12 mb-4">
                        <div id="viz-violin" class="viz-container"></div>
                    </div>
                </div>
            </div>
        </div>

        <!-- ML Analysis Section -->
        <div id="ml-analysis-section" class="content-section" style="display: none;">
            <div class="chart-container">
                <h3 class="chart-title">Phân tích Machine Learning</h3>
                <div id="ml-models-performance"></div>
                <div id="ml-feature-importance" class="mt-4"></div>
                <div id="ml-recommendations" class="mt-4"></div>
            </div>
        </div>

        <!-- Clustering Section -->
        <div id="clustering-section" class="content-section" style="display: none;">
            <div class="chart-container">
                <h3 class="chart-title">Phân tích Clustering</h3>
                <div id="clustering-results"></div>
                <div id="clustering-visualization" class="mt-4"></div>
            </div>
        </div>

        <!-- Statistical Tests Section -->
        <div id="statistical-tests-section" class="content-section" style="display: none;">
            <div class="chart-container">
                <h3 class="chart-title">Kiểm định thống kê</h3>
                <div id="statistical-tests-results"></div>
            </div>
        </div>

        <!-- Recommendations Section -->
        <div id="recommendations-section" class="content-section" style="display: none;">
            <div class="chart-container">
                <h3 class="chart-title">Khuyến nghị chiến lược</h3>
                <div id="recommendations-content"></div>
            </div>
        </div>
    </div>

    <!-- Bootstrap JS -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/bootstrap/5.3.0/js/bootstrap.bundle.min.js"></script>

    <!-- Custom JavaScript -->
    <script src="{{ url_for('static', filename='js/main.js') }}"></script>
</body>
</html>