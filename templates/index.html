<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Mental Health Analytics Platform</title>

    <!-- External Libraries -->
    <link href="https://cdnjs.cloudflare.com/ajax/libs/bootstrap/5.3.0/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/4.1.1/animate.min.css" rel="stylesheet">

    <!-- Custom Styles -->
    <link href="{{ url_for('static', filename='css/main.css') }}" rel="stylesheet">
    <link href="{{ url_for('static', filename='css/components.css') }}" rel="stylesheet">
    <link href="{{ url_for('static', filename='css/responsive.css') }}" rel="stylesheet">

    <!-- External Scripts -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/plotly.js/2.24.1/plotly.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/d3/7.8.5/d3.min.js"></script>
</head>
<body>
    <!-- Loading Screen -->
    <div id="loadingContainer" class="loading-container">
        <div>
            <div class="loading-spinner"></div>
            <div class="loading-text">Loading data...</div>
        </div>
    </div>

    <!-- Auto-loading Status -->
    <div id="autoLoadingStatus" class="auto-loading-status" style="display: none;">
        <div class="status-indicator loading"></div>
        <span id="statusText">Auto-loading data...</span>
    </div>

    <!-- Sidebar Navigation -->
    <div id="sidebar" class="sidebar">
        <div style="text-align: center; margin-bottom: 30px;">
            <h4 style="color: var(--text-primary); font-weight: 700;">
                <i class="fas fa-brain" style="color: var(--accent-color);"></i>
                Mental Analytics
            </h4>
        </div>

        <div class="nav-item active" data-section="dashboard">
            <i class="fas fa-tachometer-alt"></i>
            <span>Dashboard</span>
            <div class="status-indicator"></div>
        </div>

        <div class="nav-item" data-section="data-overview">
            <i class="fas fa-database"></i>
            <span>Data Overview</span>
            <div class="status-indicator"></div>
        </div>

        <div class="nav-item" data-section="visualizations">
            <i class="fas fa-chart-pie"></i>
            <span>Visualizations</span>
            <div class="status-indicator"></div>
        </div>

        <div class="nav-item" data-section="ml-analysis">
            <i class="fas fa-robot"></i>
            <span>ML Analysis</span>
            <div class="status-indicator"></div>
        </div>

        <div class="nav-item" data-section="clustering">
            <i class="fas fa-project-diagram"></i>
            <span>Clustering</span>
            <div class="status-indicator"></div>
        </div>

        <div class="nav-item" data-section="statistical-tests">
            <i class="fas fa-calculator"></i>
            <span>Statistical Tests</span>
            <div class="status-indicator"></div>
        </div>

        <div class="nav-item" data-section="work-arrangement">
            <i class="fas fa-briefcase"></i>
            <span>Work Impact Analysis</span>
            <div class="status-indicator"></div>
        </div>

        <div class="nav-item" data-section="recommendations">
            <i class="fas fa-lightbulb"></i>
            <span>Recommendations</span>
            <div class="status-indicator"></div>
        </div>
    </div>

    <!-- Sidebar Toggle -->
    <div id="sidebarToggle" class="sidebar-toggle">
        <i class="fas fa-bars"></i>
    </div>

    <!-- Main Content -->
    <div id="mainContent" class="main-content">
        <!-- Header -->
        <div class="header-section animate__animated animate__fadeInDown">
            <h1><i class="fas fa-brain"></i> Mental Health Analytics Platform</h1>
            <p>Advanced mental health analytics system for workforce wellbeing with AI and Machine Learning</p>

            <div style="margin-top: 25px;">
                <button id="reloadDataBtn" class="btn-glass me-3">
                    <i class="fas fa-sync"></i> Reload Data
                </button>
                <button id="startAnalysisBtn" class="btn-glass me-3">
                    <i class="fas fa-play"></i> Full Analysis
                </button>
                <button id="exportReportBtn" class="btn-glass">
                    <i class="fas fa-download"></i> Export Report
                </button>
            </div>
        </div>

        <!-- Alert Messages -->
        <div id="alertContainer"></div>

        <!-- Dashboard Section -->
        <div id="dashboard-section" class="content-section">
            <!-- Quick Stats -->
            <div id="quickStats" class="row">
                <div class="col-md-3">
                    <div class="stats-card animate__animated animate__fadeInUp">
                        <div class="icon"><i class="fas fa-users"></i></div>
                        <div class="value" id="totalRecords">-</div>
                        <div class="label">Total Records</div>
                    </div>
                </div>
                <div class="col-md-3">
                    <div class="stats-card animate__animated animate__fadeInUp animate__delay-1s">
                        <div class="icon"><i class="fas fa-columns"></i></div>
                        <div class="value" id="totalColumns">-</div>
                        <div class="label">Data Columns</div>
                    </div>
                </div>
                <div class="col-md-3">
                    <div class="stats-card animate__animated animate__fadeInUp animate__delay-2s">
                        <div class="icon"><i class="fas fa-exclamation-triangle"></i></div>
                        <div class="value" id="missingValues">-</div>
                        <div class="label">Missing Values</div>
                    </div>
                </div>
                <div class="col-md-3">
                    <div class="stats-card animate__animated animate__fadeInUp animate__delay-3s">
                        <div class="icon"><i class="fas fa-memory"></i></div>
                        <div class="value" id="memoryUsage">- MB</div>
                        <div class="label">Memory Usage</div>
                    </div>
                </div>
            </div>

            <!-- Initial Dashboard Chart -->
            <div id="dashboardChart" class="chart-container" style="display: none;">
                <h3 class="chart-title">Dashboard Overview</h3>
                <div id="dashboardPlotArea"></div>
            </div>

            <!-- Features Overview -->
            <div class="row mt-4">
                <div class="col-md-4">
                    <div class="feature-card" data-feature="advanced-viz">
                        <div class="feature-icon"><i class="fas fa-chart-area"></i></div>
                        <div class="feature-title">Advanced Visualizations</div>
                        <div class="feature-description">Interactive 3D charts, Sunburst diagrams, Correlation heatmaps with filtering capabilities</div>
                    </div>
                </div>
                <div class="col-md-4">
                    <div class="feature-card" data-feature="ml-models">
                        <div class="feature-icon"><i class="fas fa-brain"></i></div>
                        <div class="feature-title">Machine Learning</div>
                        <div class="feature-description">Random Forest, Gradient Boosting, Logistic Regression with cross-validation and feature importance</div>
                    </div>
                </div>
                <div class="col-md-4">
                    <div class="feature-card" data-feature="clustering">
                        <div class="feature-icon"><i class="fas fa-sitemap"></i></div>
                        <div class="feature-title">Smart Clustering</div>
                        <div class="feature-description">K-means clustering with PCA projection, silhouette analysis, and optimal k detection</div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Data Overview Section -->
        <div id="data-overview-section" class="content-section" style="display: none;">
            <div class="chart-container">
                <h3 class="chart-title">Data Overview and Schema</h3>
                <div id="dataOverviewContent">
                    <!-- Skeleton loading -->
                    <div class="skeleton skeleton-text"></div>
                    <div class="skeleton skeleton-text short"></div>
                    <div class="skeleton skeleton-text"></div>
                </div>
            </div>
        </div>

        <!-- Visualizations Section -->
        <div id="visualizations-section" class="content-section" style="display: none;">
            <!-- Filter Controls -->
            <div class="filter-container">
                <div class="filter-title">
                    <i class="fas fa-filter"></i> Data Filters
                </div>
                <div class="row">
                    <div class="col-md-3">
                        <label class="form-label">Region</label>
                        <select id="regionFilter" class="form-select">
                            <option value="all">All Regions</option>
                        </select>
                    </div>
                    <div class="col-md-3">
                        <label class="form-label">Industry</label>
                        <select id="industryFilter" class="form-select">
                            <option value="all">All Industries</option>
                        </select>
                    </div>
                    <div class="col-md-3">
                        <label class="form-label">Mental Health Status</label>
                        <select id="mentalHealthFilter" class="form-select">
                            <option value="all">All Status</option>
                        </select>
                    </div>
                    <div class="col-md-3">
                        <button id="applyFiltersBtn" class="btn-glass" style="margin-top: 32px;">
                            <i class="fas fa-search"></i> Apply Filters
                        </button>
                    </div>
                </div>
            </div>

            <!-- Chart Containers -->
            <div id="dashboardOverviewChart" class="chart-container">
                <h3 class="chart-title">Dashboard Overview</h3>
                <div id="dashboardOverviewPlot">
                    <div class="skeleton skeleton-chart"></div>
                </div>
            </div>

            <div id="scatter3dChart" class="chart-container">
                <h3 class="chart-title">3D Analysis: Age - Working Hours - Work-Life Balance</h3>
                <div id="scatter3dPlot">
                    <div class="skeleton skeleton-chart"></div>
                </div>
            </div>

            <div id="correlationChart" class="chart-container">
                <h3 class="chart-title">Correlation Matrix</h3>
                <div id="correlationPlot">
                    <div class="skeleton skeleton-chart"></div>
                </div>
            </div>

            <div id="sunburstChart" class="chart-container">
                <h3 class="chart-title">Multi-level Distribution</h3>
                <div id="sunburstPlot">
                    <div class="skeleton skeleton-chart"></div>
                </div>
            </div>

            <div id="violinChart" class="chart-container">
                <h3 class="chart-title">Isolation by Work Arrangement</h3>
                <div id="violinPlot">
                    <div class="skeleton skeleton-chart"></div>
                </div>
            </div>
        </div>

        <!-- ML Analysis Section -->
        <div id="ml-analysis-section" class="content-section" style="display: none;">
            <!-- Model Performance with Accuracy Threshold -->
            <div class="chart-container">
                <h3 class="chart-title">Machine Learning Model Performance</h3>
                <div id="mlPerformanceAlert" class="alert alert-warning" style="display: none;">
                    <i class="fas fa-exclamation-triangle"></i>
                    <strong>Low Accuracy Warning:</strong> Model accuracy is below 70%. Consider feature engineering or alternative analysis approaches.
                </div>
                <div id="mlModelsContent">
                    <div class="skeleton skeleton-text"></div>
                    <div class="skeleton skeleton-text short"></div>
                </div>
            </div>

            <!-- Alternative Analysis for Low Accuracy -->
            <div id="alternativeAnalysis" class="chart-container" style="display: none;">
                <h3 class="chart-title">Descriptive Analysis & Pattern Recognition</h3>
                <div id="descriptiveContent">
                    <!-- Descriptive statistics and patterns when ML accuracy is low -->
                </div>
            </div>

            <div class="row">
                <div class="col-md-6">
                    <div class="chart-container">
                        <h3 class="chart-title">Feature Importance Analysis</h3>
                        <div id="featureImportanceContent">
                            <div class="skeleton skeleton-chart"></div>
                        </div>
                    </div>
                </div>

                <div class="col-md-6">
                    <div class="chart-container">
                        <h3 class="chart-title">Model Evaluation</h3>
                        <div id="modelEvaluationContent">
                            <div class="skeleton skeleton-chart"></div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Enhanced Clustering Section -->
        <div id="clustering-section" class="content-section" style="display: none;">
            <!-- Include clustering section HTML -->
        </div>

        <!-- Statistical Tests Section -->
        <div id="statistical-tests-section" class="content-section" style="display: none;">
            <!-- Include statistical tests section HTML -->
        </div>

        <!-- Work Arrangement Section -->
        <div id="work-arrangement-section" class="content-section" style="display: none;">
            <!-- Include work arrangement section HTML -->
        </div>

        <!-- Recommendations Section -->
        <div id="recommendations-section" class="content-section" style="display: none;">
            <!-- Include recommendations section HTML -->
        </div>
    </div>

    <!-- Bootstrap JS -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/bootstrap/5.3.0/js/bootstrap.bundle.min.js"></script>

    <!-- Custom JavaScript -->
    <script src="{{ url_for('static', filename='js/app.js') }}"></script>
    <script src="{{ url_for('static', filename='js/utils.js') }}"></script>
    <script src="{{ url_for('static', filename='js/navigation.js') }}"></script>
    <script src="{{ url_for('static', filename='js/data-manager.js') }}"></script>
    <script src="{{ url_for('static', filename='js/data-analysis.js') }}"></script>
    <script src="{{ url_for('static', filename='js/visualization-manager.js') }}"></script>
    <script src="{{ url_for('static', filename='js/ml-analysis.js') }}"></script>
    <script src="{{ url_for('static', filename='js/clustering.js') }}"></script>
    <script src="{{ url_for('static', filename='js/statistical-tests.js') }}"></script>
    <script src="{{ url_for('static', filename='js/work-arrangement.js') }}"></script>
    <script src="{{ url_for('static', filename='js/recommendations.js') }}"></script>
    <script src="{{ url_for('static', filename='js/report-exporter.js') }}"></script>
</body>
</html>